<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>IndoorJSON Preview Viewer (v6) — Overlay + Route</title>

  <!-- External libs -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <script src="https://unpkg.com/earcut@2.2.4/dist/earcut.min.js"></script>

  <!-- App styles -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="app">
  <aside id="side">

    <div class="block">
      <div class="label">View</div>
      <div id="tabs">
        <button id="btn3d" class="active">3D</button>
        <button id="btn2d">2D</button>
      </div>
    </div>

    <div class="block">
      <div class="label">Level</div>
      <select id="level">
        <option value="__all__">All</option>
      </select>
      <div class="checkrow" style="margin-top:8px;">
        <input id="toggleDual" type="checkbox"/>
        <label for="toggleDual">Show dual graph (nodes & edges)</label>
      </div>
    </div>

    <div class="block">
      <div class="label">Options</div>
      <div id="tabs">
        <button id="fit">Fit view</button>
        <button id="reset">Reset</button>
      </div>
    </div>

    <div class="block">
      <div class="label">Selection</div>
      <pre id="sel">{}</pre>
    </div>

    <div class="block">
      <div class="label">Cursor (2D)</div>
      <pre id="cursor">Move mouse over the 2D view…</pre>
    </div>

    <div class="block">
      <details false>
        <summary style="cursor: pointer; font-weight: bold; font-size: 1.1em; color: #2c3e50;">
          IndoorFeatures
        </summary>
        
        <div style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #eee;">
          
          <div class="label">POST to: <span id="collection-post-target-name" style="color:blue;">select on right side bar</span> </div>
          <input id="file-input" type="file" accept=".json,application/json" style="width: 100%;"/>
          <button id="indoorFeature-upload-button" style="margin-top: 8px; width: 100%;">Upload Feature</button>
          <div id="indoorFeature-upload-status" class="tiny"></div>

          <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

          <div class="label">DELETE: <span id="indoorFeature-delete-target-name" style="color:blue;">select on right side bar</span></div>
          <button id="indoorFeature-delete-button" class="btn-danger" style="width: 100%;">Delete Selected Feature</button>
          <div id="indoorFeature-delete-status" class="tiny"></div>
          
        </div>
      </details>
    </div>
    <div class="block">
      <details false>
        <summary style="cursor: pointer; font-weight: bold; font-size: 1.1em; color: #2c3e50;">
          InterLayerConnections
        </summary>
        <div class="label">Collection: <span id="interLayerConnection-collection-name" style="color:blue;">select on right side bar</span> </div>
        <div class="label">IndoorFeature: <span id="interLayerConnection-indoorFeature-name" style="color:blue;">select on right side bar</span> </div>
        <button id="api-get-interLayerConnections" style="margin-top: 8px; width: 100%;">Load interLayerconnections</button>
        <div class="label">Navigation</div>
        <button id="interLayerConnection-api-back" style="width: 100%; display: none; margin-bottom: 8px;">&larr; Back to Collections</button>

        <div id="interLayerConnection-db-list" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 4px; border-radius: 4px; background: white;">
          <div class="tiny">Click "Load interLayerConnections" to start.</div>
        </div>
        <div style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #eee;">
          
          <div class="label">POST to: <span id="collection-post-target-name" style="color:blue;">select on right side bar</span> </div>
          <input id="interLayerConnections-file-input" type="file" accept=".json,application/json" style="width: 100%;"/>
          <button id="interLayerConnections-upload-button" style="margin-top: 8px; width: 100%;">Upload Feature</button>
          <div id="interLayerConnections-upload-status" class="tiny"></div>

          <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

          <div class="label">DELETE: <span id="interLayerConnections-delete-target-name" style="color:blue;">select on right side bar</span></div>
          <button id="interLayerConnections-delete-button" class="btn-danger" style="width: 100%;">Delete Selected Feature</button>
          <div id="interLayerConnections-delete-status" class="tiny"></div>

        </div>
      </details>
    </div>
    <div class="block">
      <details false>
        <summary style="cursor: pointer; font-weight: bold; font-size: 1.1em; color: #2c3e50;">
          ThematicLayers
        </summary>
        <div class="label">Collection: <span id="thematicLayer-collection-name" style="color:blue;">select on right side bar</span> </div>
        <div class="label">IndoorFeature: <span id="thematicLayer-indoorFeature-name" style="color:blue;">select on right side bar</span> </div>
        <button id="api-get-thematicLayers" style="margin-top: 8px; width: 100%;">Load ThematicLayers</button>
        <div class="label">Navigation</div>
        <button id="thematicLayers-api-back" style="width: 100%; display: none; margin-bottom: 8px;">&larr; Back to Collections</button>
        
        <div id="thematicLayers-db-list" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 4px; border-radius: 4px; background: white;">
          <div class="tiny">Click "Load ThematicLayers" to start.</div>
        </div>
        <div style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #eee;">
          
          <div class="label">POST to: <span id="collection-post-target-name" style="color:blue;">select on right side bar</span> </div>
          <input id="thematicLayers-file-input" type="file" accept=".json,application/json" style="width: 100%;"/>
          <button id="thematicLayers-upload-button" style="margin-top: 8px; width: 100%;">Upload Feature</button>
          <div id="thematicLayers-upload-status" class="tiny"></div>

          <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

          <div class="label">DELETE: <span id="thematicLayers-delete-target-name" style="color:blue;">select on right side bar</span></div>
          <button id="thematicLayers-delete-button" class="btn-danger" style="width: 100%;">Delete Selected Feature</button>
          <div id="thematicLayers-delete-status" class="tiny"></div>
          <details false>
            <summary style="cursor: pointer; font-weight: bold; font-size: 1.1em; color: #f10a16;">
              PrimalSpaceLayer
            </summary>
            <button id="api-get-primalSpaceLayer" style="margin-top: 8px; width: 100%; color:aquamarine;">Load PrimalSpaceLayer</button>
            <div class="label">Navigation</div>
            <button id="primalSpaceLayer-api-back" style="width: 100%; display: none; margin-bottom: 8px;">&larr; Back to Collections</button>

            <div id="primalSpaceLayer-db-list" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 4px; border-radius: 4px; background: white;">
              <div class="tiny">Click "Load PrimalSpaceLayer" to start.</div>
            </div>
            <div style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #eee;">
              
              <div class="label">POST to: <span id="collection-post-target-name" style="color:blue;">select on right side bar</span> </div>
              <input id="primalSpaceLayer-file-input" type="file" accept=".json,application/json" style="width: 100%;"/>
              <div style="display: flex; gap: 8px;">
                <button id="primalSpaceLayer-upload-button" style="margin-top: 8px; width: 100%; color:aquamarine;">POST</button>
                <button id="primalSpaceLayer-patch-button" style="margin-top: 8px; width: 100%; color:aquamarine;">PATCH</button>
              </div>
              
              <div id="primalSpaceLayer-upload-status" class="tiny"></div>

              <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

              <div class="label">DELETE: <span id="primalSpaceLayer-delete-target-name" style="color:blue;">select on right side bar</span></div>
              <button id="primalSpaceLayer-delete-button" class="btn-danger" style="width: 100%;color:aquamarine;">Delete Selected PrimalSpace Member</button>
              <div id="primalSpaceLayer-delete-status" class="tiny"></div>
            </div>
          </details>
          <details false>
            <summary style="cursor: pointer; font-weight: bold; font-size: 1.1em; color: #f10a16;">
              DualSpaceLayer
            </summary>
            <button id="api-get-dualSpaceLayer" style="margin-top: 8px; width: 100%; color:aquamarine;">Load DualSpaceLayer</button>
            <div class="label">Navigation</div>
            <button id="dualSpaceLayer-api-back" style="width: 100%; display: none; margin-bottom: 8px;">&larr; Back to Collections</button>

            <div id="dualSpaceLayer-db-list" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 4px; border-radius: 4px; background: white;">
              <div class="tiny">Click "Load DualSpaceLayer" to start.</div>
            </div>
            <div style="margin-top: 15px; padding-left: 10px; border-left: 2px solid #eee;">
              
              <div class="label">POST to: <span id="collection-post-target-name" style="color:blue;">select on right side bar</span> </div>
              <input id="dualSpaceLayer-file-input" type="file" accept=".json,application/json" style="width: 100%;"/>
              <div style="display: flex; gap: 8px;">
                <button id="dualSpaceLayer-upload-button" style="margin-top: 8px; width: 100%; color:aquamarine;">POST</button>
                <button id="dualSpaceLayer-patch-button" style="margin-top: 8px; width: 100%; color:aquamarine;">PATCH</button>
              </div>
              
              <div id="dualSpaceLayer-upload-status" class="tiny"></div>

              <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

              <div class="label">DELETE: <span id="dualSpaceLayer-delete-target-name" style="color:blue;">select on right side bar</span></div>
              <button id="dualSpaceLayer-delete-button" class="btn-danger" style="width: 100%; color:aquamarine;">Delete Selected DualSpace Member</button>
              <div id="dualSpaceLayer-delete-status" class="tiny"></div>
            </div>
          </details>
        </div>
      </details>
    </div>
  </aside>

  <main id="main">
    <div id="plots">
      <div id="plot3d" class="plot active"></div>
      <div id="plot2d" class="plot"></div>
    </div>
  </main>

  <aside id="side-right">
    <div class="block">
      <div class="label">API Explorer</div>
      <button id="api-get-collections" style="width: 100%;">Load Collections</button>
      <div id="api-status-right" class="tiny" style="margin-top:4px;">No collections loaded.</div>
    </div>

    <div class="block">
      <div class="label">Navigation</div>
      <button id="api-back" style="width: 100%; display: none; margin-bottom: 8px;">&larr; Back to Collections</button>
      
      <div id="db-list" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 4px; border-radius: 4px; background: white;">
        <div class="tiny">Click "Load Collections" to start.</div>
      </div>

      <button id="visualize" style="margin-top: 8px; width: 100%;">Visualize</button>
    </div>

    <div class="block">
      <div class="label">API Log</div>
      <pre id="api-log">{}</pre>
    </div>
  </aside>
</div>
</div>

<!-- App logic -->
<script type="module" src="./geometry.js"></script>
<script type="module" src="./viewer.js"></script>
</body>
</html>
