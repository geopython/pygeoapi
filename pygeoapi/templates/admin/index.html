
{% extends "_base.html" %}
{% block title %}{{ super() }} Admin {% endblock %}

{% macro render_block(_key, _val) %}
  <div>
    <table>
      {% if data.isdict(_val) %}
      {% for k, v in _val.items() %}
      <tr>
        <th> {{ k }} </th>
        <td>
          {% if data.isdict(v) %}
            {{ render_block(k, v)}}
          {% elif data.islist(v) %}
            {% for _v in v %}
              {{ render_block(loop.index, _v) }}
            {% endfor %}
          {% else %}
            {{ v }}
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    {% endif %}
    </table>
  </div>
{% endmacro %}

{% block body %}
  
  <div id="app">
    <p> [[ metadata  ]] {{ [[ metadata ]] }} [[ test ]]</p>
    {{ render_block('Server',  data.config.server ) }}
    {{ render_block('Metadata',  data.config.metadata ) }}
    {{ render_block('Resources',  data.config.resources ) }}
    <v-treeview
      rounded
      hoverable
      activatable
      :items="resources"
    ></v-treeview>
  </div>
{% endblock %}

{% block extrafoot %}
<script src="https://unpkg.com/vue"></script>
<script>
const app = new Vue({
    el: '#app',
    vuetify: new Vuetify(),
    data: {
        test: "fuck",
        server: {{ data.config.server }},
        metadata: {{ data.config.metadata }},
        resources: {{ data.config.resources }}
    },
    delimiters: ['[[',']]']
})
</script>
{% endblock %}